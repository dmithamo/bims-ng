<div class="w-full sm:ml-28 mb-20">
  <app-logo [disableClick]="true" />
</div>

<div class="flex flex-col items-center w-full">
  <form
    (submit)="login()"
    class="shadow flex flex-col gap-y-10 px-10 py-14 rounded w-[400px] bg-white border border-slate-300"
    [formGroup]="loginForm">
    <app-page-header
      pageTitle="Sign in to your account"
      [hideBackButton]="true" />

    <label for="email" class="relative block">
      <span class="font-bold">Email</span>
      <input
        id="email"
        formControlName="username"
        type="email"
        class="w-full mt-1 p-3 pl-10 rounded bg-slate-50 border border-slate-300 focus:bg-white focus:border focus:border-black focus:outline-none disabled:bg-slate-50 invalid:border-red-500 invalid:text-red-500"
        placeholder="Enter your email address" />
      <app-svg-icon
        iconName="at-symbol"
        iconClass="absolute left-0 ml-3 top-6 mt-4 text-gray-400" />

      @if (hasFieldError('username')) {
        @if (username.errors?.['required']) {
          <div class="flex items-center gap-2 text-red-500 mt-2">
            <app-svg-icon iconName="exclamation-circle" />
            <span>Please enter your email address</span>
          </div>
        }

        @if (username.errors?.['email']) {
          <div class="flex items-center gap-2 text-red-500 mt-2">
            <app-svg-icon iconName="exclamation-circle" />
            <span>Please enter a valid email address</span>
          </div>
        }
      }
    </label>

    <label for="password" class="relative block">
      <span class="font-bold">Password</span>
      <input
        id="password"
        formControlName="password"
        [type]="showPassword() ? 'text' : 'password'"
        class="w-full mt-1 p-3 pl-10 rounded bg-slate-50 border border-slate-300 focus:bg-white focus:border focus:border-black focus:outline-none disabled:bg-slate-50 invalid:border-red-500 invalid:text-red-500"
        placeholder="Enter your password" />
      <app-svg-icon
        iconName="lock-closed"
        iconClass="absolute left-0 ml-3 top-6 mt-4 text-gray-400" />

      <app-svg-icon
        (click)="toggleShowPassword()"
        [iconName]="togglePasswordIcon()"
        iconClass="absolute right-0 mr-3 top-6 mt-4 text-gray-400 hover:text-primary cursor-pointer" />

      @if (hasFieldError('password')) {
        @if (password.errors?.['required']) {
          <div class="flex items-center gap-2 text-red-500 mt-2">
            <app-svg-icon iconName="exclamation-circle" />
            <span>Please enter your password</span>
          </div>
        }

        @if (password.errors?.['minlength']) {
          <div class="flex items-center gap-2 text-red-500 mt-2">
            <app-svg-icon iconName="exclamation-circle" />
            <span
              >Your password must be at least
              {{ password.errors?.['minlength'].requiredLength }} characters
              long</span
            >
          </div>
        }
      }
    </label>

    @if (loginError()) {
      <div class="flex items-center gap-2 text-red-500 mt-2">
        <app-svg-icon iconName="exclamation-circle" />
        <span> {{ loginError() }}</span>
      </div>
    }

    <button
      type="submit"
      class="mt-8 bg-accent rounded text-white text-2xl py-3 px-16 flex items-center justify-center gap-x-4 disabled:bg-slate-300 disabled:cursor-not-allowed"
      [disabled]="loginForm.touched && loginForm.invalid">
      <app-svg-icon iconName="send" />
      <span>Sign in</span>
    </button>

    <a
      class="text-secondary-100 underline underline-offset-4"
      [routerLink]="APP_ROUTE.forgotPassword"
      >Forgot password?</a
    >
  </form>
</div>
